<div class="col-md-12 margin-bottom-20">
  <h1>
    <%= "Tags" %>
  </h1>
  <div class="row">
    <div class="col-md-10 margin-bottom-20">
      <%= link_to ExLink.human_attribute_name(:delete_unused_tags),
                  {action: 'del_unused_tags'},
                  :data => { :confirm => 'Are you sure you want to delete unusued tags?' },
                  :class => 'btn danger' %>
    </div>
    <div class="col-md-10 margin-bottom-20">
      <ul class="list-inline badge-lists">
        | 
          <%= link_to ExLink.human_attribute_name(:all_tags),
                      action: 'index', class: 'btn secondary' %> |
        <% @tags.each do |tagname, number| %>
            <%= link_to "#{tagname} (#{number})",
                        action: 'index', tag: tagname ,
                        class: 'btn secondary'%> |
        <% end %>
      </ul>
    </div>
  </div>
</div>
<div class="col-md-12 margin-bottom-20">
  <h1>
    <%= models_name(ExLink) %>
  </h1>
  <div class="row">
    <div class="col-md-10 margin-bottom-20">
      <%= link_to ExLink.human_attribute_name(:new_external_link),
                  new_admin_ex_link_path, class: 'btn primary' %>
      <%= link_to ExLink.human_attribute_name(:check_expired_links),
                  {action: 'check_expired'}, class: 'btn danger' %>
      <%= link_to ExLink.human_attribute_name(:check_dead_links),
                  {action: 'check_dead'}, class: 'btn danger' %>
    </div>
  </div>
  <div class="row">
    <div class="col-md-10 margin-bottom-20">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>
              <%= ExLink.human_attribute_name(:image) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:label) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:url) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:tags) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:test_availability) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:active) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:expiration) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:note) %>
            </th>
            <th>
              <%= ExLink.human_attribute_name(:action) %>
            </th>
          </tr>
        </thead>
        <tbody>
          <% @ex_links.each do |ex_link| %>
            <tr>
              <td>
                <%= image_tag ex_link.image.url(:thumb), width: 30 %>
              </td>
              <td>
                <%= truncate(ex_link.label, :length => 30) %>
              </td>
              <td>
                <%= link_to truncate(ex_link.url, :length => 30), ex_link.url %>
              </td>
              <td>
                <%= tags2labs ex_link.get_tagnames %>
              </td>
              <td>
                <%= bool2icon ex_link.test_availability %>
              </td>
              <td>
                <%= bool2icon ex_link.active %>
              </td>
              <td>
                <%= ex_link.expiration %>
              </td>
              <td>
                <%= truncate(ex_link.note, :length => 30) %>
              </td>
              <td>
                <div class="btn-group">
                  <!-- TODO: Should be dropdown! -->
                  <%= link_to ExLink.human_attribute_name(:show),
                              admin_ex_link_path(ex_link), :method => 'get',
                              class:'btn primary' %>
                  <ul class="dropdown-menu" role="menu">
                    <li>
                      <%= link_to ExLink.human_attribute_name(:show),
                                  admin_ex_link_path(ex_link),
                                  :method => 'get' %>
                    </li>
                    <li>
                      <%= link_to ExLink.human_attribute_name(:edit),
                                  edit_admin_ex_link_path(ex_link),
                                  :method => 'get' %>
                    </li>
                    <li>
                      <%= link_to ExLink.human_attribute_name(:destroy),
                                  admin_ex_link_path(ex_link),
                                  :method => :delete,
                                  :data => { :confirm => 'Are you sure?' } %>
                    </li>
                  </ul>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
