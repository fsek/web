<div class="top">
  <div class="container">
    <ul class="loginbar pull-right">
        <li class="locale-switcher">
      <% if I18n.locale == :sv %>
        <%= link_to(params.merge(locale: :en)) do %>
          <%= image_tag('layout/gb.png', class: 'flag') %>
          <span>ENGLISH</span>
        <% end %>
      <% else %>
        <%= link_to(params.merge(locale: :sv)) do %>
          <%= image_tag('layout/se.png', class: 'flag') %>
          <span>SVENSKA</span>
        <% end %>
      <% end %>
      </li>
      <li class="divider"></li>
      <li><%= link_to(fa_icon('calendar'), calendars_path) %></li>
      <li class="divider"></li>
      <% if user_signed_in? %>
        <% if current_user.permissions.any? %>
          <%= render 'layouts/admin_dropdown' %>
          <li class="divider"></li>
        <% end %>

        <% if current_user.groups.count > 0 %>
          <li class="dropdown">
            <%= render 'layouts/groups_dropdown' %>
          <li class="divider"></li>
        <% end %>

        <li class="dropdown">
          <%= link_to(current_user, class: 'dropdown-toggle',
                                    data: { toggle: 'dropdown', delay: '0' }) do %>
            <%= fa_icon('user') %> <%= current_user %>
            <span id="notification-top-count">
              <% if current_user.notifications_count > 0 %>
                  <%= current_user.notifications_count %>
              <% end %>
            </span>
          <% end %>
          <ul class="dropdown-menu pull-right">
            <li>
              <%= link_to own_user_path do %>
                <%= fa_icon('cog') %>
                <%= t('.user_settings') %>
              <% end %>
            <li>
              <%= link_to own_user_notifications_path do %>
                <%= fa_icon('bell') %>
                <%= models_name(Notification) %>
                <span id="notification-dropdown-count">
                  <%= current_user.notifications_count %>
                </span>
              <% end %>
            </li>
            <li>
              <%= link_to(destroy_user_session_path, method: :delete) do %>
                <%= fa_icon('sign-out') %> <%= t('devise.sign_out') %>
              <% end %>
            </li>
          </ul>
        </li>
      <% else %>
        <li>
          <%= link_to(new_user_session_path) do %>
            <%= fa_icon('sign-in') %> <%= t('devise.sign_in') %>
          <% end %>
        </li>
        <li class="divider"></li>
        <li>
          <%= link_to(new_user_registration_path) do %>
            <%= fa_icon('plus') %> <%= t('devise.sign_up') %>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
</div>
